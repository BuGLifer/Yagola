
# DDL 변경 이력
|  버전   |                                   사유                                    |
|:-----:|:-----------------------------------------------------------------------:|
| 1.0.2 |                             CREATED_TIME 반영                             |
| 1.0.3 |                             FK NOT NULL 반영                              |
| 1.0.4 |                    Restaurant > Category Chicken 추가                     |
| 1.1.0 |                         Spring Batch 관련 테이블 추가                          |
| 1.1.1 | Menu Table Description 컬럼 추가, <br/>Resturant Table Category Enum > Set 타입 변경 |
|1.1.2| UserOrder Table M_SEQ, RV_SEQ null 허용 변경|
# DDL
## 1.1.2
```mysql
CREATE TABLE BATCH_JOB_INSTANCE  (
JOB_INSTANCE_ID BIGINT  NOT NULL PRIMARY KEY ,
VERSION BIGINT ,
JOB_NAME VARCHAR(100) NOT NULL,
JOB_KEY VARCHAR(32) NOT NULL,
constraint JOB_INST_UN unique (JOB_NAME, JOB_KEY)
) ENGINE=InnoDB;

CREATE TABLE `batch_job_execution` (
`JOB_EXECUTION_ID` bigint(20) NOT NULL,
`VERSION` bigint(20) DEFAULT NULL,
`JOB_INSTANCE_ID` bigint(20) NOT NULL,
`CREATE_TIME` datetime(6) NOT NULL,
`START_TIME` datetime(6) DEFAULT NULL,
`END_TIME` datetime(6) DEFAULT NULL,
`STATUS` varchar(10) DEFAULT NULL,
`EXIT_CODE` varchar(2500) DEFAULT NULL,
`EXIT_MESSAGE` varchar(2500) DEFAULT NULL,
`LAST_UPDATED` datetime(6) DEFAULT NULL,
`JOB_CONFIGURATION_LOCATION` varchar(2500) DEFAULT NULL,
PRIMARY KEY (`JOB_EXECUTION_ID`),
KEY `JOB_INST_EXEC_FK` (`JOB_INSTANCE_ID`),
CONSTRAINT `JOB_INST_EXEC_FK` FOREIGN KEY (`JOB_INSTANCE_ID`) REFERENCES `batch_job_instance` (`JOB_INSTANCE_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE BATCH_JOB_EXECUTION_PARAMS  (
JOB_EXECUTION_ID BIGINT NOT NULL ,
TYPE_CD VARCHAR(6) NOT NULL ,
KEY_NAME VARCHAR(100) NOT NULL ,
STRING_VAL VARCHAR(250) ,
DATE_VAL DATETIME(6) DEFAULT NULL ,
LONG_VAL BIGINT ,
DOUBLE_VAL DOUBLE PRECISION ,
IDENTIFYING CHAR(1) NOT NULL ,
constraint JOB_EXEC_PARAMS_FK foreign key (JOB_EXECUTION_ID)
references BATCH_JOB_EXECUTION(JOB_EXECUTION_ID)
) ENGINE=InnoDB;

CREATE TABLE BATCH_STEP_EXECUTION  (
STEP_EXECUTION_ID BIGINT  NOT NULL PRIMARY KEY ,
VERSION BIGINT NOT NULL,
STEP_NAME VARCHAR(100) NOT NULL,
JOB_EXECUTION_ID BIGINT NOT NULL,
START_TIME DATETIME(6) NOT NULL ,
END_TIME DATETIME(6) DEFAULT NULL ,
STATUS VARCHAR(10) ,
COMMIT_COUNT BIGINT ,
READ_COUNT BIGINT ,
FILTER_COUNT BIGINT ,
WRITE_COUNT BIGINT ,
READ_SKIP_COUNT BIGINT ,
WRITE_SKIP_COUNT BIGINT ,
PROCESS_SKIP_COUNT BIGINT ,
ROLLBACK_COUNT BIGINT ,
EXIT_CODE VARCHAR(2500) ,
EXIT_MESSAGE VARCHAR(2500) ,
LAST_UPDATED DATETIME(6),
constraint JOB_EXEC_STEP_FK foreign key (JOB_EXECUTION_ID)
references BATCH_JOB_EXECUTION(JOB_EXECUTION_ID)
) ENGINE=InnoDB;

CREATE TABLE BATCH_STEP_EXECUTION_CONTEXT  (
STEP_EXECUTION_ID BIGINT NOT NULL PRIMARY KEY,
SHORT_CONTEXT VARCHAR(2500) NOT NULL,
SERIALIZED_CONTEXT TEXT ,
constraint STEP_EXEC_CTX_FK foreign key (STEP_EXECUTION_ID)
references BATCH_STEP_EXECUTION(STEP_EXECUTION_ID)
) ENGINE=InnoDB;

CREATE TABLE BATCH_JOB_EXECUTION_CONTEXT  (
JOB_EXECUTION_ID BIGINT NOT NULL PRIMARY KEY,
SHORT_CONTEXT VARCHAR(2500) NOT NULL,
SERIALIZED_CONTEXT TEXT ,
constraint JOB_EXEC_CTX_FK foreign key (JOB_EXECUTION_ID)
references BATCH_JOB_EXECUTION(JOB_EXECUTION_ID)
) ENGINE=InnoDB;

CREATE TABLE BATCH_STEP_EXECUTION_SEQ (
ID BIGINT NOT NULL,
UNIQUE_KEY CHAR(1) NOT NULL,
constraint UNIQUE_KEY_UN unique (UNIQUE_KEY)
) ENGINE=InnoDB;

INSERT INTO BATCH_STEP_EXECUTION_SEQ (ID, UNIQUE_KEY) select * from (select 0 as ID, '0' as UNIQUE_KEY) as tmp where not exists(select * from BATCH_STEP_EXECUTION_SEQ);

CREATE TABLE BATCH_JOB_EXECUTION_SEQ (
ID BIGINT NOT NULL,
UNIQUE_KEY CHAR(1) NOT NULL,
constraint UNIQUE_KEY_UN unique (UNIQUE_KEY)
) ENGINE=InnoDB;

INSERT INTO BATCH_JOB_EXECUTION_SEQ (ID, UNIQUE_KEY) select * from (select 0 as ID, '0' as UNIQUE_KEY) as tmp where not exists(select * from BATCH_JOB_EXECUTION_SEQ);

CREATE TABLE BATCH_JOB_SEQ (
ID BIGINT NOT NULL,
UNIQUE_KEY CHAR(1) NOT NULL,
constraint UNIQUE_KEY_UN unique (UNIQUE_KEY)
) ENGINE=InnoDB;

INSERT INTO BATCH_JOB_SEQ (ID, UNIQUE_KEY) select * from (select 0 as ID, '0' as UNIQUE_KEY) as tmp where not exists(select * from BATCH_JOB_SEQ);

-- yagola.tb_comment definition
CREATE TABLE `tb_comment` (
`C_SEQ` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT '댓글 SEQ',
`COMMENT` varchar(1000) DEFAULT NULL COMMENT '댓글 내용',
`P_SEQ` mediumint(9) unsigned DEFAULT NULL COMMENT '대댓글 용 부모 ID,\r\nNULL : 원글\r\nNOT NULL : 부모 댓글 SEQ',
`CREATED_TIME` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '생성 일자',
`VIEW` tinyint(1) NOT NULL DEFAULT '0' COMMENT '노출, 미사용 FLAG\r\n0 : 비노출, 미사용, False\r\n1 : 노출, 사용, True',
`U_SEQ` mediumint(9) unsigned NOT NULL COMMENT '사용자 시퀀스 ID',
`O_SEQ` mediumint(9) unsigned NOT NULL COMMENT '주문 시퀀스',
PRIMARY KEY (`C_SEQ`),
KEY `FK_TB_ORDER_TO_TB_COMMENT_1` (`O_SEQ`),
KEY `FK_TB_USER_TO_TB_COMMENT_1` (`U_SEQ`),
CONSTRAINT `FK_TB_ORDER_TO_TB_COMMENT_1` FOREIGN KEY (`O_SEQ`) REFERENCES `tb_order` (`O_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT `FK_TB_USER_TO_TB_COMMENT_1` FOREIGN KEY (`U_SEQ`) REFERENCES `tb_user` (`U_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `tb_menu` (
`M_SEQ` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT '메뉴 SEQ',
`NAME` varchar(100) DEFAULT NULL COMMENT '메뉴 이름',
`PRICE` mediumint(8) unsigned NOT NULL DEFAULT '0' COMMENT '메뉴 가격',
`IMG_LINK` varchar(512) DEFAULT NULL COMMENT '요기요 이미지 Link 주소',
`R_SEQ` mediumint(9) unsigned NOT NULL COMMENT '식당 SEQ',
`CREATED_TIME` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '생성 일자',
`DESCRIPTION` varchar(2000) DEFAULT NULL COMMENT '메뉴 설명',
PRIMARY KEY (`M_SEQ`),
KEY `FK_TB_RESTAURANT_TO_TB_MENU_1` (`R_SEQ`),
CONSTRAINT `FK_TB_RESTAURANT_TO_TB_MENU_1` FOREIGN KEY (`R_SEQ`) REFERENCES `tb_restaurant` (`R_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

CREATE TABLE `tb_order` (
`O_SEQ` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT '주문 시퀀스',
`STATUS` enum('ONLINE','OFFLINE','ORDER','ARRIVAL') NOT NULL DEFAULT 'ONLINE' COMMENT '주문 상태, ONLINE : 참여 가능, OFFLINE : 참여 마감, ORDER : 주문 진행, ARRIVAL : 도착 완료',
`CREATED_TIME` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '주문 생성 일자',
`OFFLINE_TIME` timestamp NULL DEFAULT NULL COMMENT '마감 상태(OFFLINE ) 일자',
`ORDER_TIME` timestamp NULL DEFAULT NULL COMMENT '주문 상태(ORDER) 일자',
`ARRIVAL_TIME` timestamp NULL DEFAULT NULL COMMENT '도착 상태(ARRIVAL) 일자',
`R_SEQ` mediumint(9) unsigned DEFAULT NULL COMMENT '식당 SEQ',
PRIMARY KEY (`O_SEQ`),
KEY `FK_TB_RESTAURANT_TO_TB_ORDER_1` (`R_SEQ`),
CONSTRAINT `FK_TB_RESTAURANT_TO_TB_ORDER_1` FOREIGN KEY (`R_SEQ`) REFERENCES `tb_restaurant` (`R_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

CREATE TABLE `tb_restaurant` (
`R_SEQ` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT '식당 SEQ',
`NAME` varchar(100) DEFAULT NULL COMMENT '식당 이름',
`API_ID` varchar(100) DEFAULT NULL COMMENT '요기요 API 식당 식별 ID',
`TEL` varchar(100) DEFAULT NULL COMMENT '식당 전화번호',
`IMG_LINK` varchar(512) DEFAULT NULL COMMENT '요기요 이미지 Link 주소',
`CATEGORY` set('CHINA','KOREA','JAPAN','ALONE','FRANCHISE','WESTERN','PIG','NIGHT','SCHOOL','CAFE','MART','CHICKEN','ETC') DEFAULT 'ETC' COMMENT '식당 카테고리\r\nCHINA : 중식\r\nKOREA : 한식\r\nJAPAN : 일식/돈까스\r\nALONE : 1인분\r\nFRANCHISE : 프랜차이즈\r\nWESTERN : 피자/양식\r\nPIG : 족발/보쌈\r\nNIGHT : 야식\r\nSCHOOL : 분식\r\nCAFE : 카페/디저트\r\nMART : 편의점/마트\r\n CHICKEN: 치킨 ETC : 기타, 없음',
`CREATED_TIME` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '생성 일자',
PRIMARY KEY (`R_SEQ`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

CREATE TABLE `tb_review` (
`RV_SEQ` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT '후기 SEQ',
`LIKE` tinyint(1) NOT NULL DEFAULT '0' COMMENT '좋아요 FLAG\r\n0 : 싫어요, False\r\n1 : 좋아요, True',
`COMMENT` varchar(1000) DEFAULT NULL COMMENT '후기 내용',
`VIEW` tinyint(1) NOT NULL DEFAULT '0' COMMENT '노출, 미사용 FLAG\r\n0 : 비노출, 미사용, False\r\n1 : 노출, 사용, True',
`CREATED_TIME` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '생성일자',
`M_SEQ` mediumint(9) unsigned NOT NULL COMMENT '메뉴 SEQ',
PRIMARY KEY (`RV_SEQ`),
KEY `FK_TB_MENU_TO_TB_REVIEW_1` (`M_SEQ`),
CONSTRAINT `FK_TB_MENU_TO_TB_REVIEW_1` FOREIGN KEY (`M_SEQ`) REFERENCES `tb_menu` (`M_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- yagola.tb_user definition
CREATE TABLE `tb_user` (
`U_SEQ` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT '사용자 시퀀스 ID',
`NICKNAME` varchar(100) DEFAULT NULL COMMENT '사용자 닉네임',
`IP` varchar(100) DEFAULT NULL COMMENT 'IP 주소',
`CREATED_TIME` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '생성 일자',
PRIMARY KEY (`U_SEQ`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;

CREATE TABLE `tb_user_order` (
 `UO_SEQ` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT '사용자 주문 SEQ',
 `U_SEQ` mediumint(9) unsigned NOT NULL COMMENT '사용자 시퀀스 ID',
 `O_SEQ` mediumint(9) unsigned NOT NULL COMMENT '주문 시퀀스',
 `HOST` tinyint(1) NOT NULL DEFAULT '0' COMMENT '원글 작성자 여부 FLAG\r\n0 : 참여자, False\r\n1 : 작성자, True',
 `CREATED_TIME` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '생성 일자',
 `M_SEQ` mediumint(9) unsigned DEFAULT NULL COMMENT '메뉴 SEQ',
 `RV_SEQ` mediumint(9) unsigned DEFAULT NULL COMMENT '후기 SEQ',
 PRIMARY KEY (`UO_SEQ`),
 KEY `FK_TB_REVIEW_TO_TB_USER_ORDER_1` (`RV_SEQ`),
 KEY `FK_TB_MENU_TO_TB_USER_ORDER_1` (`M_SEQ`),
 KEY `FK_TB_ORDER_TO_TB_USER_ORDER_1` (`O_SEQ`),
 KEY `FK_TB_USER_TO_TB_USER_ORDER_1` (`U_SEQ`),
 CONSTRAINT `FK_TB_MENU_TO_TB_USER_ORDER_1` FOREIGN KEY (`M_SEQ`) REFERENCES `tb_menu` (`M_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE,
 CONSTRAINT `FK_TB_ORDER_TO_TB_USER_ORDER_1` FOREIGN KEY (`O_SEQ`) REFERENCES `tb_order` (`O_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE,
 CONSTRAINT `FK_TB_REVIEW_TO_TB_USER_ORDER_1` FOREIGN KEY (`RV_SEQ`) REFERENCES `tb_review` (`RV_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE,
 CONSTRAINT `FK_TB_USER_TO_TB_USER_ORDER_1` FOREIGN KEY (`U_SEQ`) REFERENCES `tb_user` (`U_SEQ`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
```
